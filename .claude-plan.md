# BridgeBreak Implementation Plan

## Overview
Building a client and project management web application with a Vercel-like UI design, featuring dual user roles (Client/Admin), project tracking, payments, support, and notifications.

## Technical Stack
- **Framework**: Next.js 13.5.1 (App Router)
- **Database**: Supabase PostgreSQL
- **Authentication**: Supabase Auth (email/password)
- **Storage**: Supabase Storage (for files, voice notes, QR codes)
- **UI**: shadcn/ui + Tailwind CSS (Vercel-style neutral/grayscale theme)
- **Forms**: React Hook Form + Zod
- **Notifications**: In-app notification system

## Database Schema

### Core Tables

#### 1. users (extends Supabase auth.users)
```sql
- id (uuid, references auth.users)
- email (text)
- full_name (text)
- role (enum: 'client', 'admin')
- avatar_url (text, nullable)
- created_at (timestamptz)
- updated_at (timestamptz)
```

#### 2. projects
```sql
- id (uuid, primary key)
- client_id (uuid, references users)
- title (text)
- description (text)
- status (enum: 'pending', 'under_review', 'accepted', 'in_progress', 'testing', 'completed', 'cancelled')
- github_link (text, nullable)
- estimated_cost (decimal, nullable)
- actual_cost (decimal, nullable)
- deadline (date, nullable)
- test_asset_url (text, nullable)
- deployment_url (text, nullable)
- created_at (timestamptz)
- updated_at (timestamptz)
```

#### 3. project_files
```sql
- id (uuid, primary key)
- project_id (uuid, references projects)
- file_name (text)
- file_url (text)
- file_type (enum: 'document', 'voice_note', 'image', 'other')
- file_size (bigint)
- uploaded_by (uuid, references users)
- created_at (timestamptz)
```

#### 4. project_updates
```sql
- id (uuid, primary key)
- project_id (uuid, references projects)
- update_text (text)
- created_by (uuid, references users)
- created_at (timestamptz)
```

#### 5. support_requests
```sql
- id (uuid, primary key)
- project_id (uuid, references projects, nullable)
- client_id (uuid, references users)
- subject (text)
- description (text)
- status (enum: 'open', 'in_progress', 'resolved', 'closed')
- priority (enum: 'low', 'medium', 'high')
- created_at (timestamptz)
- updated_at (timestamptz)
```

#### 6. support_messages
```sql
- id (uuid, primary key)
- support_request_id (uuid, references support_requests)
- user_id (uuid, references users)
- message (text)
- created_at (timestamptz)
```

#### 7. meeting_requests
```sql
- id (uuid, primary key)
- project_id (uuid, references projects, nullable)
- client_id (uuid, references users)
- requested_date (timestamptz)
- duration_minutes (integer)
- purpose (text)
- status (enum: 'pending', 'accepted', 'declined', 'completed')
- meeting_link (text, nullable)
- admin_notes (text, nullable)
- created_at (timestamptz)
- updated_at (timestamptz)
```

#### 8. invoices
```sql
- id (uuid, primary key)
- project_id (uuid, references projects)
- client_id (uuid, references users)
- invoice_number (text, unique)
- amount (decimal)
- due_date (date)
- status (enum: 'pending', 'paid', 'overdue', 'cancelled')
- payment_qr_url (text, nullable)
- bank_details (jsonb, nullable)
- paid_at (timestamptz, nullable)
- created_at (timestamptz)
- updated_at (timestamptz)
```

#### 9. payments
```sql
- id (uuid, primary key)
- invoice_id (uuid, references invoices)
- amount (decimal)
- payment_method (text)
- transaction_id (text, nullable)
- payment_date (timestamptz)
- notes (text, nullable)
- created_at (timestamptz)
```

#### 10. team_members
```sql
- id (uuid, primary key)
- name (text)
- email (text)
- role (text)
- monthly_salary (decimal)
- joined_date (date)
- status (enum: 'active', 'inactive')
- created_at (timestamptz)
- updated_at (timestamptz)
```

#### 11. salary_payments
```sql
- id (uuid, primary key)
- team_member_id (uuid, references team_members)
- amount (decimal)
- payment_date (date)
- month (date)
- notes (text, nullable)
- created_at (timestamptz)
```

#### 12. notifications
```sql
- id (uuid, primary key)
- user_id (uuid, references users)
- title (text)
- message (text)
- type (enum: 'project', 'payment', 'support', 'meeting', 'system')
- link (text, nullable)
- read (boolean, default false)
- created_at (timestamptz)
```

#### 13. system_settings
```sql
- id (uuid, primary key)
- key (text, unique)
- value (jsonb)
- updated_at (timestamptz)
```

## Application Structure

### Page Routes

#### Authentication
- `/login` - Login page
- `/register` - Client registration
- `/forgot-password` - Password reset

#### Client Pages
- `/dashboard` - Client dashboard (projects overview, pending payments, notifications)
- `/projects` - All projects list
- `/projects/new` - Create new project
- `/projects/[id]` - Project details (status, updates, files, timeline)
- `/invoices` - View invoices and payment history
- `/support` - Support tickets list
- `/support/new` - Create support ticket
- `/support/[id]` - Support ticket details and chat
- `/meetings` - Meeting requests list
- `/meetings/new` - Request new meeting
- `/profile` - User profile settings

#### Admin Pages
- `/admin/dashboard` - Admin dashboard (stats, pending projects, revenue)
- `/admin/projects` - Manage all projects
- `/admin/projects/[id]` - Review and manage project
- `/admin/clients` - Client management
- `/admin/support` - Handle support requests
- `/admin/meetings` - Manage meeting requests
- `/admin/invoices` - Invoice management
- `/admin/invoices/new` - Create invoice
- `/admin/payments` - Track all payments
- `/admin/finance` - Revenue and salary tracking
- `/admin/team` - Team member management
- `/admin/settings` - System settings

### Key Components

#### Layout Components
- `Header` - Navigation with user menu, notifications bell
- `Sidebar` - Role-based navigation menu
- `DashboardShell` - Wrapper for dashboard pages
- `NotificationDropdown` - In-app notifications

#### Project Components
- `ProjectCard` - Project summary card
- `ProjectStatusBadge` - Visual status indicator
- `ProjectTimeline` - Timeline visualization
- `ProjectFilesUpload` - Multi-file upload with voice notes
- `ProjectUpdateForm` - Admin form to post updates

#### Payment Components
- `InvoiceCard` - Invoice summary
- `PaymentQRCode` - Display QR code for payment
- `BankDetails` - Display bank information
- `PaymentHistory` - Transaction list

#### Support Components
- `SupportTicketCard` - Ticket summary
- `SupportChat` - Real-time chat interface
- `TicketStatusBadge` - Status indicator

#### Admin Components
- `ProjectReviewForm` - Set cost, timeline, accept/reject
- `RevenueChart` - Financial analytics
- `ClientList` - Client management table
- `TeamMemberForm` - Add/edit team members
- `SalaryTracker` - Monthly salary tracking

#### Common Components
- `StatsCard` - Dashboard statistics
- `DataTable` - Reusable table with sorting/filtering
- `FileUpload` - Drag-and-drop file upload
- `DateRangePicker` - Date selection
- `EmptyState` - No data placeholder

### Design System (Vercel-like)

#### Colors
```css
--background: 0 0% 100%         /* White */
--foreground: 0 0% 3.9%         /* Near black text */
--card: 0 0% 100%               /* White cards */
--card-foreground: 0 0% 3.9%
--border: 0 0% 89.8%            /* Light gray borders */
--muted: 0 0% 96.1%             /* Very light gray backgrounds */
--muted-foreground: 0 0% 45.1%  /* Medium gray text */
--accent: 0 0% 96.1%            /* Subtle highlights */
```

#### Typography
- Font: System font stack (Geist-like)
- Headings: 600-700 weight
- Body: 400-500 weight
- Scale: 12px, 14px, 16px (base), 18px, 24px, 32px, 48px

#### Spacing
- Consistent 8px grid
- Card padding: 24px
- Component gaps: 16px
- Section spacing: 32px-48px

#### Components
- Minimalist buttons with subtle hover states
- Thin borders (1px)
- Subtle shadows on cards
- Clean, spacious layouts
- Generous whitespace

## Implementation Phases

### Phase 1: Foundation (Database & Auth)
1. Create Supabase migration for all tables
2. Set up Row Level Security (RLS) policies
3. Configure Supabase Storage buckets (project-files, invoices, avatars)
4. Implement authentication flow (login, register, logout)
5. Create auth context and protected route wrapper
6. Set up user role management

### Phase 2: Core Layout & Navigation
1. Build root layout with header and sidebar
2. Create role-based navigation components
3. Implement notification system (backend + UI)
4. Build dashboard shells for client and admin
5. Create shared components (stats cards, empty states)

### Phase 3: Project Management (Client)
1. Create project list and detail pages
2. Build project creation form with file uploads
3. Implement project status tracking
4. Add project timeline view
5. Create project update feed

### Phase 4: Project Management (Admin)
1. Build admin project review interface
2. Implement cost and timeline estimation forms
3. Create project status management
4. Add deliverable upload (test assets, deployment links)
5. Build project update posting

### Phase 5: Support & Meetings
1. Create support request system
2. Build support chat interface
3. Implement meeting request flow
4. Add meeting management for admin
5. Create support ticket status tracking

### Phase 6: Payments & Finance
1. Build invoice creation and management
2. Implement payment tracking
3. Create QR code and bank details display
4. Add payment history views
5. Build admin finance dashboard
6. Implement team member and salary tracking

### Phase 7: Polish & Optimization
1. Add loading states and skeletons
2. Implement error handling
3. Add form validations
4. Optimize database queries
5. Add toast notifications for actions
6. Test all user flows

## Critical Files to Create/Modify

### New Files
- `lib/supabase/client.ts` - Supabase client initialization
- `lib/supabase/server.ts` - Server-side Supabase client
- `lib/auth/context.tsx` - Auth context provider
- `lib/auth/hooks.ts` - useUser, useAuth hooks
- `lib/db/queries.ts` - Database query functions
- `lib/db/types.ts` - TypeScript types from schema
- `middleware.ts` - Route protection middleware
- `app/(auth)/login/page.tsx` - Login page
- `app/(auth)/register/page.tsx` - Registration
- `app/(client)/dashboard/page.tsx` - Client dashboard
- `app/(admin)/admin/dashboard/page.tsx` - Admin dashboard
- `components/layout/header.tsx` - App header
- `components/layout/sidebar.tsx` - Navigation sidebar
- `components/notifications/notification-bell.tsx` - Notifications dropdown
- Multiple component files per feature area

### Modified Files
- `app/layout.tsx` - Add auth provider, theme provider
- `app/globals.css` - Update color variables for Vercel theme
- `tailwind.config.ts` - Adjust theme colors

## Security Considerations

1. **RLS Policies**: Strict row-level security for all tables
   - Clients can only view their own data
   - Admins have full access
2. **File Upload**: Validate file types and sizes
3. **Authentication**: Secure session management
4. **API Routes**: Verify user roles before operations
5. **Data Validation**: Zod schemas for all forms
6. **SQL Injection**: Use parameterized queries
7. **XSS Prevention**: Sanitize user input

## Next Steps After Approval

1. Create database migration
2. Set up authentication system
3. Build core layouts and navigation
4. Implement features phase by phase
5. Test each feature as completed
6. Run final build and deployment check
